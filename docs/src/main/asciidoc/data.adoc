= Data Access


== Data Gravity

== JDBC [[jdbc]]

== Database Schema Migration with Liquibase and Flyway

== JPA Data Access [[jpa]]
=== Using Spring Data's sweet Java 8 support (`Optional<T>` results,  https://github.com/spring-projects/spring-data-examples/blob/master/jpa/java8/src/main/java/example/springdata/jpa/java8/CustomerRepository.java[Java 8 default  methods  to unpack finder methods], etc.)

== NOSQL? NoSQL? No Sweat!
== Couchbase
== Neo4j
== MongoDB
== Redis

== Extreme Data Integration with Spring XD

- https://github.com/spring-projects/spring-bus

Spring XD can be deployed onto CF now because the pieces are now separated into smaller Boot-based auto-configurations. See Fisher's XOLPOC[https://github.com/markfisher/xolpoc] and Dr. Syer's auto-configuration for XD modules[]. Here r the notes from a Skype convo w/ the good Dr. Syer:

```
[5/21/15, 1:06:33 AM] David Syer: Just putting together a README
[5/21/15, 1:06:34 AM] David Syer: 1sec
[5/21/15, 1:14:19 AM] David Syer: https://github.com/dsyer/spring-xd-module-runner
[5/21/15, 1:15:55 AM] David Syer: "Spring XD Module as a Microservice"
[5/21/15, 1:16:02 AM] Josh Long: Whoa!
[5/21/15, 1:16:33 AM] David Syer: or (equivalently) CF/lattice app
[5/21/15, 1:16:44 AM] Josh Long: So u polished off the bits in fisher's static void main example and added the appropriate @Enable annotation?
[5/21/15, 1:16:47 AM] Josh Long: This is so cool
[5/21/15, 1:16:54 AM] Josh Long: What about the admin node ?
[5/21/15, 1:16:58 AM] David Syer: Or Azure, GCE or Heroku or whatever
[5/21/15, 1:22:11 AM] Josh Long: This is amazing
[5/21/15, 2:57:34 AM] David Syer: Artem helped me fix the Java config version
[5/21/15, 2:57:42 AM] David Syer: New code on master nice and shiny
[5/21/15, 2:59:28 AM] David Syer: There is no admin node
[5/21/15, 2:59:44 AM] David Syer: OR if there is then it doesn't know about your standalone modules
[5/21/15, 3:08:33 AM] Josh Long: Wait so what do we get out of Using the module if it doesn't plugin to an admin node somewhere ?
[5/21/15, 3:09:31 AM] David Syer: Local testing for one
[5/21/15, 3:09:49 AM] David Syer: Independent control of scaling and deployment if you want to run it as a standalone
[5/21/15, 3:10:03 AM] David Syer: You don't need XD at all, just redis or rabbit
[5/21/15, 3:10:09 AM] Josh Long: How does that part work?
[5/21/15, 3:10:19 AM] David Syer: XD has a MessageBus abstraction
[5/21/15, 3:10:25 AM] Josh Long: Oh!! So u get the ability to register as a spring integration handler ?
[5/21/15, 3:10:28 AM] David Syer: It just wraps input and output channels
[5/21/15, 3:11:05 AM] David Syer: Basically, yes. It's like microservices where the broker does discovery
[5/21/15, 3:11:47 AM] Josh Long: Discovery = delivers to all the nodes connected to a MQ?
[5/21/15, 3:11:57 AM] David Syer: Yes
[5/21/15, 3:12:09 AM] David Syer: You say "I provide this 'service' (=message source), called 'foo'" or "I wish to consume a 'service' called 'foo'"
[5/21/15, 3:12:19 AM] David Syer: xd.group=foo
[5/21/15, 3:12:23 AM] David Syer: (in Boot config)
[5/21/15, 3:12:38 AM] David Syer: consumers have higher indexes than producers
[5/21/15, 3:12:57 AM] David Syer: I'm sure we can work partitioning and other XD features in
[5/21/15, 3:13:06 AM] David Syer: Taps should work
[5/21/15, 3:13:36 AM] Josh Long: So do I configure full XD streams?
[5/21/15, 3:14:25 AM] Josh Long: That is this is just a single module (a professor righ?) how do I describe sources, sinks and then connect them in streams w/o XD admin node?
[5/21/15, 3:15:46 AM] David Syer: I'm just adding a source sample now
[5/21/15, 3:15:59 AM] David Syer: You need a Channel called "input" and an index>0
[5/21/15, 3:16:11 AM] David Syer: 1 for a sink connected directly to a source
[5/21/15, 3:19:11 AM] David Syer: https://github.com/dsyer/spring-xd-module-runner/tree/master/spring-xd-module-runner-sample-sink
[5/21/15, 3:19:48 AM] David Syer: The "stream" name is the "xd.group" config label
[5/21/15, 3:20:16 AM] David Syer: The index just counts the pipes in the "stream definition"
[5/21/15, 3:20:27 AM] David Syer: Those 2 apps talk to each other
[5/21/15, 3:20:43 AM] David Syer: https://github.com/dsyer/spring-xd-module-runner/tree/master/spring-xd-module-runner-sample-source (the original sample renamed)
[5/21/15, 3:34:08 AM] Josh Long: So how do u compose a stream? By well known convention of property names?
[5/21/15, 3:34:44 AM] David Syer: Yes
[5/21/15, 3:35:08 AM] Josh Long: This reminds me of what I wanted to do a few years ago w activiti so that wait states were messages sent to queues and there was a convention to register handles (thus states could be farmed across the grid via RabbitMq or Jms )
[5/21/15, 3:35:16 AM] David Syer: In the samples they both have xd.group="testtock"
[5/21/15, 3:35:47 AM] David Syer: The sink has index=1, and the source has index=0 (they just need to be consecutive)
[5/21/15, 3:35:49 AM] Josh Long: this is awesome I will clone and run soon I'm walking around Kiev, Ukraine atm on Edge
[5/21/15, 3:36:05 AM] Josh Long: Oh! So can I reuse any of the sources / sinks from XD?
[5/21/15, 3:37:23 AM] David Syer: Indeed
[5/21/15, 3:37:33 AM] David Syer: You can spy on or send messages to an existing XD
[5/21/15, 3:46:04 AM] Josh Long: So I still need XD proper to setup a stream that, for example, uses the XD Kafka source ?
[5/21/15, 3:57:50 AM] David Syer: Yes
[5/21/15, 3:58:08 AM] David Syer: (Except spring-xd-module-runner doesn't have Kafka support yet for the transport)
[5/21/15, 3:59:03 AM] David Syer: I just added support for taps and a new sample
[5/21/15, 3:59:16 AM] David Syer:
xd:
  module:
    group: tocktap
    name: logger
    index: 0
    tap:
      group: testtock
      name: ticker
      index: 0
[5/21/15, 4:05:44 AM] Josh Long: So I guess I'm confused -- how do I setup an XD stream that reads from kafka or ftp and then deploy the whole solution (save for the ftp or Kafka source themselves) to CF?
[5/21/15, 4:06:41 AM] David Syer: On CF you have to forgo admin and the whole XD cluster thing
[5/21/15, 4:07:23 AM] David Syer: FTP source runs in CF as far as I know
[5/21/15, 4:07:28 AM] David Syer: kafka not
[5/21/15, 4:08:10 AM] David Syer: Unless there's a kafka service that I haven't seen yet (I know there's a research project for PCF)
[5/21/15, 4:09:10 AM] David Syer: Let's start with your stream definition (if you were to use XD)
[5/21/15, 4:09:30 AM] David Syer: "ftp | what?"
[5/21/15, 4:38:33 AM] Josh Long: Right but I'm ignoring the source itself - lets just pick any that come out of the box w Spring XD
[5/21/15, 4:38:52 AM] Josh Long: How do I compose a stream w them? How do I reuse them w just a module?
[5/21/15, 4:42:43 AM] Josh Long: I'm confused because I thought u plugged a module into XD and it had lots of plumbing to string that module together as part of a larger pipeline including to reuse the existing source / sinks
[5/21/15, 4:43:37 AM] Josh Long: Right now it sounds like I lose the plumbing that handles the scaling (ok..) and the batteries (sources, sinks, jobs) that come out of the box (this is where I'm sad/hopeful).
[5/21/15, 4:43:57 AM] Josh Long: I naively thought that was what the admin module provided
[5/21/15, 5:04:14 AM] David Syer: You can still use the existing sources/sinks if you use Mark's xolpoc
[5/21/15, 5:04:35 AM] David Syer: (the thing he demo-ed in Cambridge)
[5/21/15, 5:06:43 AM] Josh Long: Right - van we get that stood up w Boot @EnableXdAdmin or something like that?
[5/21/15, 5:07:27 AM] David Syer: xolpoc has a main() method
[5/21/15, 5:07:30 AM] David Syer: You just use that
```

== Spring Data and Security Integration
It's possible to defer to https://github.com/spring-projects/spring-data-examples/blob/master/jpa/security/src/main/java/example/springdata/jpa/security/SecureBusinessObjectRepository.java[use Spring Expression Language expressions inside of query definitions].
